#include <stdio.h>
#include <time.h>
#include <stdlib.h>

#define ARRAY_SIZE  1000000

#define swap(a, b) do { \
    /*typedef(a) temp;*/    \
        int tmp;        \
        tmp = a;        \
        a = b;          \
        b = tmp;        \
    } while(0)

// It's a problem when &a == &b
#define swap2(a, b) do {\
        a = a ^ b;      \
        b = a ^ b;      \
        a = a ^ b;      \
    } while(0)

#define swap3(a, b) do { a ^= b ^= a ^= b;} while(0)

int main()
{
    int arr[ARRAY_SIZE];
    for (int i = 0; i < ARRAY_SIZE; i++)
    {
        //srand(time(0)); //use current time as seed for random generator
        //arr[i] = rand();
        arr[i] = i; 
    }

    clock_t start, finish;
    //double total_time;
    int total_time;

    start = clock();

    int a = 111, b = 222;
    for (int i = 0; i < 0xFFFFFF; i++)
    {
        //swap(arr[i], arr[i+1]);
        swap(a, b);
    }

    finish = clock();
    total_time = (finish - start);
    printf( "%d seconds\n", start); 
    printf( "%d seconds\n", total_time); 

    start = clock();

    for (int i = 0; i < ARRAY_SIZE - 1; i++)
    {
        swap2(arr[i], arr[i+1]);
    }

    finish = clock();
    total_time = (double)(finish - start) / CLOCKS_PER_SEC; 
    printf( "%f seconds\n", total_time); 

    start = clock();

    for (int i = 0; i < ARRAY_SIZE - 1; i++)
    {
        swap3(arr[i], arr[i+1]);
    }

    finish = clock();
    total_time = (double)(finish - start) / CLOCKS_PER_SEC; 
    printf( "%f seconds\n", total_time); 

    return 0;
}
